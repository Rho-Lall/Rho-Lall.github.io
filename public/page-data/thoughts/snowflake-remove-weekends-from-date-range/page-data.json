{"componentChunkName":"component---src-pages-thoughts-mdx-slug-js","path":"/thoughts/snowflake-remove-weekends-from-date-range/","result":{"data":{"mdx":{"frontmatter":{"title":"Snowflake SQL: How do I exclude weekends between two dates in Snowflake SQL?","short":"\nCommon ask in BI is to return the working days between two dates not the calendar days.\n","keywords":"working days between two dates, snowflake networkdays, bi developer, data driven development","hero_alt":"Snowflake SQL: How do I exclude weekends between two dates in Snowflake SQL?","date":"June 12, 2018","hero_image":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/217ac44efb5208795651dee9b027be72/87706/development_sql.png","srcSet":"/static/217ac44efb5208795651dee9b027be72/f80f8/development_sql.png 320w,\n/static/217ac44efb5208795651dee9b027be72/9a63f/development_sql.png 640w,\n/static/217ac44efb5208795651dee9b027be72/87706/development_sql.png 1280w","sizes":"(min-width: 1280px) 1280px, 100vw"},"sources":[{"srcSet":"/static/217ac44efb5208795651dee9b027be72/c0bcc/development_sql.webp 320w,\n/static/217ac44efb5208795651dee9b027be72/17574/development_sql.webp 640w,\n/static/217ac44efb5208795651dee9b027be72/71d4d/development_sql.webp 1280w","type":"image/webp","sizes":"(min-width: 1280px) 1280px, 100vw"}]},"width":1280,"height":720}}}},"slug":"snowflake-remove-weekends-from-date-range","body":"var _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"Snowflake SQL: How do I exclude weekends between two dates in Snowflake SQL?\",\n  \"date\": \"2018-06-12\",\n  \"hero_image\": \"./media/development_sql.png\",\n  \"hero_alt\": \"Snowflake SQL: How do I exclude weekends between two dates in Snowflake SQL?\",\n  \"expertise\": \"Development\",\n  \"author\": \"Rho Lall\",\n  \"keywords\": \"working days between two dates, snowflake networkdays, bi developer, data driven development\",\n  \"short\": \"\\nCommon ask in BI is to return the working days between two dates not the calendar days.\\n\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"This post has been updated with additional content and a cleaner format. You can read the updated 2023 version here:\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/thoughts/snowflake-datediff-business-days\"\n  }, \"Snowflake DateDiff Business Days\"), mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/thoughts/snowflake-datediff-business-days\"\n  }, \": How Do I Exclude Weekends?\")), mdx(\"h3\", null, \"Original Post\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"select\"), mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"DATEDIFF('day', '2022-07-01', '2022-07-14') + 1\"), mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"- DATEDIFF('week', '2022-07-01', DATEADD('day', 1, '2022-07-14'))\"), mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"- DATEDIFF('week', '2022-07-01', '2022-07-14') as working_days\"), mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \";\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"DATEDIFF('day', '2022-07-01', '2022-07-14') + 1\"), \"\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"select\"), \"\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"DATEDIFF('day', '2022-07-01', '2022-07-14') + 1\")), mdx(\"p\", null, \"This first expression naively counts days between start and end.\\nThe +1 means the end_date is included as part of the count.\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"- DATEDIFF('week', '2022-07-01', DATEADD('day', 1, '2022-07-14'))\")), mdx(\"p\", null, \"This second expression counts Saturdays.\\nSince there can never be fewer Saturdays than Sundays in a given range because\\nSnowflake starts the week on Monday and Sunday is after Saturday,\\nwe will check whether the last day in the range is a Saturday.\\nThis expression checks by calculating how many weeks there are in this range if the last day is forwarded by one day.\\nFor example, if the last day is a Friday, then it moves to Saturday, and that partial week doesn't count towards our total\\nbecause DATEDIFF('week', ...) only counts fully completed weeks.\\nHowever, if the last day is a Saturday, then it gets bumped to a Sunday, and this count will increase.\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"- DATEDIFF('week', '2022-07-01', '2022-07-14') as working_days\"), mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \";\")), mdx(\"p\", null, \"This third piece counts the number of fully completed weeks, which will be the same as the number of Sundays in that range\\n(there is one Sunday per week).\"), mdx(\"p\", null, \"Putting all the expressions together,\\nwe subtract the Saturday count\\nand Sunday count\\nfrom the first naive count to calculate the number of weekdays elapsed in the time range.\"), mdx(\"p\", null, \"This pattern can be adjusted to accommodate different week start days\"), mdx(\"h3\", null, \"Resources:\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/thoughts/snowflake-datediff-business-days\"\n  }, \"Snowflake DateDiff Business Days\"), \": How Do I Exclude Weekends?\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.snowflake.com/en/sql-reference/functions-date-time.html#label-calendar-weeks-weekdays\"\n  }, \"https://docs.snowflake.com/en/sql-reference/functions-date-time.html#label-calendar-weeks-weekdays\")));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"07fe3148-27d1-5a75-a756-8cba9d71b998","slug":"snowflake-remove-weekends-from-date-range","__params":{"slug":"snowflake-remove-weekends-from-date-range"}}},"staticQueryHashes":["1609057278"]}