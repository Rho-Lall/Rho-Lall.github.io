{"componentChunkName":"component---src-pages-thoughts-mdx-slug-js","path":"/thoughts/snowflake-remove-weekends-from-date-range/","result":{"data":{"mdx":{"frontmatter":{"title":"Snowflake SQL: How do I exclude weekends between two dates in Snowflake SQL?","short":"\nCommon ask in BI is to return the working days between two dates not the calendar days.\n","keywords":"working days between two dates, snowflake networkdays, bi developer, data driven development","hero_alt":"Snowflake SQL: How do I exclude weekends between two dates in Snowflake SQL?","date":"June 12, 2018","hero_image":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/217ac44efb5208795651dee9b027be72/87706/development_sql.png","srcSet":"/static/217ac44efb5208795651dee9b027be72/f80f8/development_sql.png 320w,\n/static/217ac44efb5208795651dee9b027be72/9a63f/development_sql.png 640w,\n/static/217ac44efb5208795651dee9b027be72/87706/development_sql.png 1280w","sizes":"(min-width: 1280px) 1280px, 100vw"},"sources":[{"srcSet":"/static/217ac44efb5208795651dee9b027be72/c0bcc/development_sql.webp 320w,\n/static/217ac44efb5208795651dee9b027be72/17574/development_sql.webp 640w,\n/static/217ac44efb5208795651dee9b027be72/71d4d/development_sql.webp 1280w","type":"image/webp","sizes":"(min-width: 1280px) 1280px, 100vw"}]},"width":1280,"height":720}}}},"slug":"snowflake-remove-weekends-from-date-range","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Snowflake SQL: How do I exclude weekends between two dates in Snowflake SQL?\",\n  \"date\": \"2018-06-12\",\n  \"hero_image\": \"./media/development_sql.png\",\n  \"hero_alt\": \"Snowflake SQL: How do I exclude weekends between two dates in Snowflake SQL?\",\n  \"expertise\": \"Development\",\n  \"author\": \"Rho Lall\",\n  \"keywords\": \"working days between two dates, snowflake networkdays, bi developer, data driven development\",\n  \"short\": \"\\nCommon ask in BI is to return the working days between two dates not the calendar days.\\n\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"`\\nselect\\nDATEDIFF('day', '2022-07-01', '2022-07-14') + 1 \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"    - DATEDIFF('week', '2022-07-01', DATEADD('day', 1, '2022-07-14'))\\n    - DATEDIFF('week', '2022-07-01', '2022-07-14')\\n    as working_days\\n;\\n\")), mdx(\"p\", null, \"select\\nDATEDIFF('day', '2022-07-01', '2022-07-14') + 1\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"      -- This first expression naively counts days between start and end. \\n      -- The +1 means the end_date is included as part of the count.\\n      \\n    - DATEDIFF('week', '2022-07-01', DATEADD('day', 1, '2022-07-14'))\\n    \\n    -- This second expression counts Saturdays. \\n    -- Since there can never be fewer Saturdays than Sundays in a given range because \\n    -- Snowflake starts the week on Monday and Sunday is after Saturday, \\n    -- we will check whether the last day in the range is a Saturday.\\n    -- This expression checks by calculating how many weeks there are in this range if the last day is forwarded by one day.\\n    -- For example, if the last day is a Friday, then it moves to Saturday, and that partial week doesn't count towards our total \\n    -- because DATEDIFF('week', ...) only counts fully completed weeks. \\n    -- However, if the last day is a Saturday, then it gets bumped to a Sunday, and this count will increase.\\n    \\n    - DATEDIFF('week', '2022-07-01', '2022-07-14')\\n    --This third piece counts the number of fully completed weeks, which will be the same as the number of Sundays in that range\\n    -- (there is one Sunday per week).\\n\\n    as working_days\\n    \\n    -- Putting all the expressions together, \\n    -- we subtract the Saturday count \\n    -- and Sunday count \\n    -- from the first naive count to calculate the number of weekdays elapsed in the time range.\\n\\n    -- This pattern can be adjusted to accommodate different week start days, \\n    \\n;\\n\")), mdx(\"p\", null, \"`\"), mdx(\"p\", null, \"Resources:\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.snowflake.com/en/sql-reference/functions-date-time.html#label-calendar-weeks-weekdays\"\n  }, \"https://docs.snowflake.com/en/sql-reference/functions-date-time.html#label-calendar-weeks-weekdays\")));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"07fe3148-27d1-5a75-a756-8cba9d71b998","slug":"snowflake-remove-weekends-from-date-range","__params":{"slug":"snowflake-remove-weekends-from-date-range"}}},"staticQueryHashes":["1609057278"]}